<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>WG-FINDER – Profilfragebogen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #f3f4f7;
      --card-bg: #ffffff;
      --border: #d2d6e0;
      --accent: #f89a28;
      --text: #222;
      --muted: #666;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 1.5rem;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    .app {
      max-width: 720px;
      margin: 0 auto;
      padding: 1.75rem 2rem 2rem;
      background: var(--card-bg);
      border-radius: 10px;
      border: 1px solid var(--border);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.04);
    }

    h1 {
      margin-top: 0;
      margin-bottom: 0.5rem;
      font-size: 1.6rem;
    }

    .intro {
      margin-top: 0;
      margin-bottom: 1.5rem;
      font-size: 0.95rem;
      color: var(--muted);
    }

    .question {
      margin-bottom: 1.5rem;
    }

    .question label {
      display: block;
      font-weight: 500;
      margin-bottom: 0.45rem;
    }

    .slider-row {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 0.75rem;
    }

    input[type="range"] {
      width: 100%;
    }

    .scale-label {
      font-size: 0.85rem;
      color: var(--muted);
    }

    .value-text {
      margin-top: 0.25rem;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .value-display {
      font-weight: 600;
      color: var(--accent);
    }

    .submit-btn {
      margin-top: 0.5rem;
      display: inline-block;
      padding: 0.55rem 1.4rem;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #fff;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
    }

    .submit-btn:hover {
      opacity: 0.92;
    }

    .status-message {
      margin-top: 0.6rem;
      font-size: 0.9rem;
    }

    .status-message.success {
      color: #1b7f3b;
    }

    .status-message.error {
      color: #b00020;
    }

    .hint {
      margin-top: 1.75rem;
      font-size: 0.82rem;
      color: var(--muted);
      border-top: 1px dashed var(--border);
      padding-top: 0.75rem;
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>WG-FINDER Profilfragebogen</h1>
    <p class="intro">
      Bitte beantworte die folgenden Fragen zu deinen WG-Präferenzen.
      <br />
      1 = überhaupt nicht wichtig, 10 = extrem wichtig.
    </p>

    <form id="survey-form">
      <div class="question">
        <label for="q1">
          Wie wichtig ist es dir, dass du und deine Mitbewohner:innen regelmäßig zusammen kocht?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q1" name="q1" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q2">
          Wie wichtig ist es dir, dass die WG unter der Woche eher ruhig ist?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q2" name="q2" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q3">
          Wie wichtig ist es dir, dass Besuch von Freund:innen oft möglich ist?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q3" name="q3" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q4">
          Wie wichtig ist es dir, dass Sauberkeit und Ordnung in der WG wichtig genommen werden?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q4" name="q4" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q5">
          Wie wichtig ist es dir, dass ihr gemeinsame Aktivitäten (z.&nbsp;B. Spiele- oder Filmabende) habt?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q5" name="q5" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q6">
          Wie wichtig ist es dir, dass du viel Privatsphäre und Rückzugsmöglichkeiten hast?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q6" name="q6" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <div class="question">
        <label for="q7">
          Wie wichtig ist es dir, dass du spontan Leute mit in die WG bringen kannst?
        </label>
        <div class="slider-row">
          <span class="scale-label">1</span>
          <input type="range" id="q7" name="q7" min="1" max="10" value="5" />
          <span class="scale-label">10</span>
        </div>
        <div class="value-text">
          Aktueller Wert: <span class="value-display">5</span>
        </div>
      </div>

      <button type="submit" class="submit-btn">Antworten speichern</button>
      <p id="status-message" class="status-message" aria-live="polite"></p>
    </form>

    <p class="hint">
      Hinweis: Deine Antworten werden nur lokal in deinem Browser
      gespeichert (localStorage) und nicht an einen Server gesendet.
    </p>
  </div>

  <script>
    const STORAGE_KEY = "wgFinderSurveyV1";

    function updateDisplay(rangeEl) {
      const questionEl = rangeEl.closest(".question");
      const displayEl = questionEl.querySelector(".value-display");
      displayEl.textContent = rangeEl.value;
    }

    function loadFromStorage() {
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (!stored) return;

        const data = JSON.parse(stored);
        if (!data || !data.answers) return;

        Object.entries(data.answers).forEach(([id, value]) => {
          const input = document.getElementById(id);
          if (input && input.type === "range") {
            input.value = value;
            updateDisplay(input);
          }
        });
      } catch (err) {
        console.warn("Konnte gespeicherte Daten nicht laden:", err);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("survey-form");
      const statusEl = document.getElementById("status-message");
      const ranges = Array.from(form.querySelectorAll('input[type="range"]'));

      // Live update for each slider
      ranges.forEach((range) => {
        updateDisplay(range); // initial
        range.addEventListener("input", () => updateDisplay(range));
      });

      // Load existing answers from localStorage (if any)
      loadFromStorage();

      form.addEventListener("submit", (event) => {
        event.preventDefault();

        const answers = {};
        ranges.forEach((range) => {
          answers[range.id] = Number(range.value);
        });

        const payload = {
          timestamp: new Date().toISOString(),
          answers,
        };

        try {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
          statusEl.textContent =
            "Deine Antworten wurden gespeichert. Du kannst jetzt die WG-Anzeigen ansehen.";
          statusEl.classList.remove("error");
          statusEl.classList.add("success");
        } catch (err) {
          console.error("Speichern in localStorage fehlgeschlagen:", err);
          statusEl.textContent =
            "Fehler beim Speichern in deinem Browser. Bitte versuche es noch einmal.";
          statusEl.classList.remove("success");
          statusEl.classList.add("error");
        }
      });
    });
  </script>
</body>
</html>
